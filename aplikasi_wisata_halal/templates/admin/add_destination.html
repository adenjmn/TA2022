<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Admin - Wisata Halal</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel='stylesheet' href='//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css'>
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css'>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css')}}">

</head>

<body>
  <!-- partial:index.partial.html -->

  <body>
    <div id="menu-overlay"></div>
    <div id="menu-toggle" class="closed" data-title="Menu">
      <i class="fa fa-bars"></i>
      <i class="fa fa-times"></i>
    </div>
    <header id="main-header">
      <nav id="sidenav">
        <div id="sidenav-header">
          <div id="profile-picture">
            <img src="http://www.gravatar.com/avatar/fa4df8540bab3cb38f7dfa60c6e0522c.png" />
          </div>
          <a href="#" id="profile-link">Jesse Couch</a>
        </div>
        <div id="account-actions">
          <a href="" data-title="Home"><i class="fa fa-home"></i></a>
          <!-- <a href="#" id="messages" data-title="Messages" data-newmessages="1"><i class="fa fa-inbox"></i></a> -->
          <a href="#" data-title="Logout"><i class="fa fa-cog"></i></a>
        </div>
        <ul id="main-nav">
          <li>
            <a href="/admin">
              <i class="fa fa-tachometer"></i>
              Dashboard
            </a>
          </li>
          <li class="active">
            <a href="../destination">
              <i class="fa fa-check-square-o"></i>
              Destination
            </a>
          </li>
          <li>
            <a href="#">
              <i class="fa fa-user"></i>
              Admin
            </a>
          </li>
        </ul>
      </nav>

    </header>
    <section id="content" class="form-style">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="destination" style="text-decoration:none">Destination</a></li>
          <li class="breadcrumb-item active" aria-current="page">add destination</li>
        </ol>
      </nav>

      <form action="/admin/add_destination/new" method="POST">
        <div class="section"><span>1</span>Destination</div>
        <div class="inner-wrap">
          <label class="id" id="id" for="id">ID Destination</label>
          <input class="form-control form-control-sm" name="id" type="text" aria-label=".form-control-sm example">
          
          <label class="name" id="name" for="name">Name</label>
          <input class="form-control form-control-sm" name="name" type="text" aria-label=".form-control-sm example">
          
          <label class="type" id="type" for="type">Type</label>
          <input class="form-control form-control-sm" value="" name="type" type="text" aria-label=".form-control-sm example">
          
          <label class="img" id="img" for="img">Link Image</label>
          <input class="form-control form-control-sm" value="" name="img" type="text" aria-label=".form-control-sm example">
          
          <label class="desc" id="desc" for="desc">Description</label>
          <textarea class="form-control form-control-sm" name="desc" rows="4"></textarea>
        </div>
        <div class="section"><span>2</span>Location - City &amp; Coordinate</div>
        <div class="inner-wrap">
          <label class="city" id="city" for="city">City</label>
          <input class="form-control form-control-sm" value="" name="city" type="text" aria-label=".form-control-sm example">
        </div>
        <div id="mapCanvas" class="inner-wrap"></div>
        <div class="inner-wrap">
          <b>Latitude:</b>
          <div id="info_lat"></div>
          <b>Longitude:</b>
          <div id="info_lon"></div>
          <input class="form-control form-control-sm" name="lat" type="hidden" aria-label=".form-control-sm example">
          <input class="form-control form-control-sm" name="lon" type="hidden" aria-label=".form-control-sm example">
          <!-- <b>URL:</b>
          <a href="" id="url" target="_blank">openMap</a>
          <br /> -->
        </div>
        
        <div class="section"><button type="submit" class="btn btn-primary">Submit</button></div>
        
      </form>

    </section>

    <footer></footer>

    <script src="{{ url_for('static', filename='js/admin_destination.js') }}"></script>
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script type="text/javascript">
      var geocoder = new google.maps.Geocoder();

      function geocodePosition(pos) {
        geocoder.geocode({
          latLng: pos
        }, function (responses) {
          if (responses && responses.length > 0) {
            updateMarkerAddress(responses[0].formatted_address);
          } else {
            updateMarkerAddress('Cannot determine address at this location.');
          }
        });
      }

      function updateMarkerStatus(str) {
        document.getElementById('markerStatus').innerHTML = str;
      }

      function updateMarkerPosition(latLng) {
        var info_lat = document.getElementById('info_lat').innerHTML = latLng.lat();
        var info_lon = document.getElementById('info_lon').innerHTML = latLng.lng();
        
        let lat = document.querySelector('input[name="lat"]');
        let lon = document.querySelector('input[name="lon"]');
        lat.value = info_lat;
        lon.value = info_lon;
        // document.getElementById("demo").value = info_lat;
      }

      function updateMarkerAddress(str) {
        document.getElementById('address').innerHTML = str;
      }

      function updateMarkerURL(str) {
        var pos = [str.lat(), str.lng()].join(',');
        var link = "https://www.google.com/maps/place/@"+pos;

        var htmlLink = document.getElementById("url");
        htmlLink.innerHTML = "Open Maps";
        htmlLink.setAttribute('href', link);
      }

      function initialize() {
        var latLng = new google.maps.LatLng(-6.1312767, 106.8001397);
        var map = new google.maps.Map(document.getElementById('mapCanvas'), {
          zoom: 15,
          center: latLng,
          mapTypeId: google.maps.MapTypeId.ROADMAP,
          streetViewControl: false
        });

        var image = 'https://cdn1.iconfinder.com/data/icons/Map-Markers-Icons-Demo-PNG/64/Map-Marker-Marker-Outside-Chartreuse.png';

        var marker = new google.maps.Marker({
          position: latLng,
          title: 'Posisi Saya',
          map: map,
          draggable: false,
          icon: image,
        });
        // Update current position info.
        updateMarkerPosition(latLng);
        geocodePosition(latLng);

        // Add dragging event listeners.
        //           google.maps.event.addListener(marker, 'dragstart', function() {
        //             updateMarkerAddress('Dragging...');
        //           });

        //           google.maps.event.addListener(marker, 'drag', function() {
        //             updateMarkerStatus('Dragging...');
        //             updateMarkerPosition(marker.getPosition());
        //           });

        //           google.maps.event.addListener(marker, 'dragend', function() {
        //             updateMarkerStatus('Drag ended');
        //             geocodePosition(marker.getPosition());
        //           });

        map.addListener('center_changed', function () {
          marker.setPosition(map.getCenter());
          //updateMarkerStatus('Center of Map');
          geocodePosition(marker.getPosition());
          updateMarkerPosition(marker.getPosition());
          updateMarkerURL(marker.getPosition());
        });

        if (navigator.geolocation) {

          navigator.geolocation.getCurrentPosition(function (position) {
            user_location = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
            map.setCenter(user_location);
          });
        } else {
          /* Browser doesn't support Geolocation */
        }
      }

      // Onload handler to fire off the app.
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>

  </body>

</html>